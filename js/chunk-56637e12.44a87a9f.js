(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-56637e12"],{1681:function(t,e,a){},"28ea":function(t,e,a){"use strict";a("9b16")},9636:function(t,e,a){"use strict";a.r(e),a("7db0"),a("a9e3"),a("a434"),a("159b"),a("c740");var i=a("d4ec"),s=a("bee2"),d=a("ade3"),o=a("677a"),n=new(function(){function t(){Object(i.a)(this,t),Object(d.a)(this,"BASE_URL","admin/GoodsManual/")}return Object(s.a)(t,[{key:"findAll",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o.a.doHttp(this.BASE_URL+"findAll","get",{page:t,pageSize:e,field:a})}},{key:"find",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return o.a.doHttp(this.BASE_URL+"find","get",{id:t,field:e})}},{key:"create",value:function(t){return delete t.id,o.a.doHttp(this.BASE_URL+"create","post",t)}},{key:"update",value:function(t){return o.a.doHttp(this.BASE_URL+"update","post",t)}},{key:"delete",value:function(t){return o.a.doHttp(this.BASE_URL+"delete","post",{id:t})}}]),t}()),l=a("f2a1"),c={name:"GoodsManual",components:{},data:function(){return{headers:[{text:"ID",value:"id",align:"center"},{text:"名称",value:"name",align:"center"},{text:"直营成本",value:"directly_cost",align:"center"},{text:"加盟成本",value:"join_cost",align:"center"},{text:"商贸成本",value:"business_cost",align:"center"},{text:"最后更新时间",value:"update_time",align:"center"},{text:"操作",value:"action",align:"center"}],items:[],pageConfig:{page:1,pageCount:1,totalDesserts:1},searchData:"",editedIndex:0,deleteDialogs:!1,editedDialogs:!1,editedData:{id:-1,name:"",step:[],directly_cost:0,join_cost:0,business_cost:0,other:""},goodsMaterials:[],editedStep:{goodsMaterialsId:0,num:0,other:""}}},created:function(){this.refresh()},mounted:function(){},methods:{refresh:function(){this.getAllGoodsMaterials(),this.findAll()},newCreate:function(){this.editedIndex=-1,this.editedData={id:-1,name:"",step:[],directly_cost:0,join_cost:0,business_cost:0,other:""},this.editedStep={goodsMaterialsId:0,num:0,other:""},this.editedDialogs=!0},find:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.editedIndex=this.items.indexOf(e),n.find(this.items[this.editedIndex].id).then((function(e){t.editedData=e.data;for(var a=0;a<t.editedData.step.length;a++)t.editedData.step[a].goodsMaterialsId=Number(t.editedData.step[a].goodsMaterialsId);t.editedDialogs=!0}))},findAll:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;n.findAll(e,a).then((function(e){t.items=e.data.data,t.pageConfig={page:e.data.current_page,pageCount:e.data.last_page,totalDesserts:e.data.total}}))},chickPage:function(t){this.findAll(t)},submit:function(){var t=this;this.editedIndex>=0?n.update(this.editedData).then((function(e){Object.assign(t.items[t.editedIndex],e.data),t.editedDialogs=!1,t.$store.commit("snackBarShow",{message:"保存成功",color:"success"})})):n.create(this.editedData).then((function(e){t.items.push(e.data),t.editedDialogs=!1,t.$store.commit("snackBarShow",{message:"保存成功",color:"success"})}))},doDelete:function(){var t=this;n.delete(this.items[this.editedIndex].id).then((function(){t.deleteDialogs=!1,t.items.splice(t.editedIndex,1),t.$store.commit("snackBarShow",{message:"删除成功",color:"success"})}))},getAllGoodsMaterials:function(){var t=this;l.a.findAll(1,9999).then((function(e){t.goodsMaterials=e.data.data}))},updateCost:function(){var t=this;t.editedData.directly_cost=0,t.editedData.join_cost=0,t.editedData.business_cost=0,t.editedData.step.length>0&&t.editedData.step.forEach((function(e){var a=t.goodsMaterials.findIndex((function(t){return Number(t.id)===Number(e.goodsMaterialsId)}));a>=0&&(t.editedData.directly_cost=t.$math.format(t.$math.evaluate(t.editedData.directly_cost+" + "+e.num+" * "+t.goodsMaterials[a].directly_cost)),t.editedData.join_cost=t.$math.format(t.$math.evaluate(t.editedData.join_cost+" + "+e.num+" * "+t.goodsMaterials[a].join_cost)),t.editedData.business_cost=t.$math.format(t.$math.evaluate(t.editedData.business_cost+" + "+e.num+" * "+t.goodsMaterials[a].business_cost)))}))},addStep:function(){this.editedStep.goodsMaterialsId<=0||null!=this.editedStep.num&&""!==this.editedStep.num&&(this.editedData.step.push(this.editedStep),this.updateCost(this.editedStep),this.editedStep={goodsMaterialsId:0,num:0,other:""})},delStep:function(t){var e=this.editedData.step.indexOf(t);this.editedData.step.splice(e,1),this.updateCost()}}},r=(a("28ea"),a("2877")),u=a("6544"),v=a.n(u),f=a("8336"),h=a("b0af"),p=a("99d9"),g=a("62ad"),m=a("8fea"),b=a("169a"),x=a("ce7e"),_=a("132d"),D=a("891e"),k=a("0fd9"),C=a("b974"),S=a("8654"),y=a("a844"),w=Object(r.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex flex-column",attrs:{id:"GoodsManual"}},[a("v-data-table",{attrs:{headers:t.headers,items:t.items,page:t.pageConfig.page,"server-items-length":t.pageConfig.totalDesserts,"hide-default-footer":""},on:{"update:page":function(e){return t.$set(t.pageConfig,"page",e)},"page-count":function(e){t.pageConfig.pageCount=e}},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-card-title",[a("div",[a("v-btn",{staticClass:"mr-5",attrs:{color:"success"},on:{click:t.newCreate}},[t._v("新增")]),a("v-btn",{staticClass:"mr-5",attrs:{color:"info"},on:{click:t.refresh}},[t._v("刷新")])],1)])]},proxy:!0},{key:"item.action",fn:function(e){var i=e.item;return[a("v-btn",{staticClass:"mr-2",attrs:{icon:""}},[a("v-icon",{attrs:{small:""},on:{click:function(e){return t.find(i)}}},[t._v(" mdi-pencil ")])],1),a("v-btn",{staticClass:"mr-2",attrs:{icon:""}},[a("v-icon",{attrs:{small:""},on:{click:function(e){t.editedIndex=t.items.indexOf(i),t.deleteDialogs=!0}}},[t._v(" mdi-delete ")])],1)]}}])}),a("div",{staticClass:"mt-auto mb-10"},[a("v-pagination",{attrs:{length:t.pageConfig.pageCount,"total-visible":10},on:{input:t.chickPage},model:{value:t.pageConfig.page,callback:function(e){t.$set(t.pageConfig,"page",e)},expression:"pageConfig.page"}})],1),a("div",[a("v-dialog",{attrs:{persistent:"",width:"300px"},model:{value:t.deleteDialogs,callback:function(e){t.deleteDialogs=e},expression:"deleteDialogs"}},[a("v-card",[a("v-card-title",[t._v(" 提示 ")]),a("v-card-text",[t._v(" 确定要删除么 ")]),a("v-card-actions",{staticClass:"d-flex justify-end"},[a("v-btn",{staticClass:"mr-3",attrs:{color:"info"},on:{click:t.doDelete}},[t._v("确定")]),a("v-btn",{on:{click:function(e){t.deleteDialogs=!1}}},[t._v("取消")])],1)],1)],1),a("v-dialog",{attrs:{persistent:"",width:"700"},model:{value:t.editedDialogs,callback:function(e){t.editedDialogs=e},expression:"editedDialogs"}},[a("v-card",[a("v-card-title",[t._v(" 详细信息 ")]),a("v-card-text",[a("v-row",[a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("ID")])]),a("v-col",{attrs:{cols:"5"}},[a("v-text-field",{attrs:{dense:"",disabled:"","hide-details":"",outlined:""},model:{value:t.editedData.id,callback:function(e){t.$set(t.editedData,"id",e)},expression:"editedData.id"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("名称")])]),a("v-col",{attrs:{cols:"5"}},[a("v-text-field",{attrs:{dense:"","hide-details":"",outlined:""},model:{value:t.editedData.name,callback:function(e){t.$set(t.editedData,"name",e)},expression:"editedData.name"}})],1)],1),a("div",{staticClass:"mt-5"},[t._v("操作步骤")]),a("v-divider",{staticClass:"mb-5"}),t._l(t.editedData.step,(function(e,i){return a("v-row",{key:i},[a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("原料")])]),a("v-col",{attrs:{cols:"5"}},[a("v-select",{attrs:{items:t.goodsMaterials,dense:"","hide-details":"","item-text":"name","item-value":"id",outlined:"",placeholder:"选择原料"},model:{value:e.goodsMaterialsId,callback:function(a){t.$set(e,"goodsMaterialsId",a)},expression:"item.goodsMaterialsId"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("用量")])]),a("v-col",{attrs:{cols:"5"}},[a("v-text-field",{attrs:{dense:"","hide-details":"",outlined:"",type:"number"},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"item.num"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("操作说明")])]),a("v-col",{attrs:{cols:"9"}},[a("v-textarea",{attrs:{"clear-icon":"mdi-close-circle",clearable:"",dense:"","hide-details":"","no-resize":"",outlined:""},model:{value:e.other,callback:function(a){t.$set(e,"other",a)},expression:"item.other"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"2"}},[a("v-btn",{staticClass:"mr-2",attrs:{color:"error",dark:"",fab:"",small:""},on:{click:function(a){return t.delStep(e)}}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-minus ")])],1),a("v-btn",{attrs:{color:"success",dark:"",fab:"",small:""},on:{click:function(a){return t.updateCost(e)}}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-pencil ")])],1)],1)],1)})),a("v-row",[a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("原料")])]),a("v-col",{attrs:{cols:"5"}},[a("v-select",{attrs:{items:t.goodsMaterials,dense:"","hide-details":"","item-text":"name","item-value":"id",outlined:"",placeholder:"选择原料"},model:{value:t.editedStep.goodsMaterialsId,callback:function(e){t.$set(t.editedStep,"goodsMaterialsId",e)},expression:"editedStep.goodsMaterialsId"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("用量")])]),a("v-col",{attrs:{cols:"5"}},[a("v-text-field",{attrs:{dense:"","hide-details":"",outlined:"",type:"number"},model:{value:t.editedStep.num,callback:function(e){t.$set(t.editedStep,"num",e)},expression:"editedStep.num"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("操作说明")])]),a("v-col",{attrs:{cols:"9"}},[a("v-textarea",{attrs:{"clear-icon":"mdi-close-circle",clearable:"",dense:"","hide-details":"","no-resize":"",outlined:""},model:{value:t.editedStep.other,callback:function(e){t.$set(t.editedStep,"other",e)},expression:"editedStep.other"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"2"}},[a("v-btn",{staticClass:"ma-auto",attrs:{color:"success",dark:"",fab:"",small:""},on:{click:t.addStep}},[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-plus ")])],1)],1)],1),a("v-divider",{staticClass:"mt-5 mb-5"}),a("v-row",[a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("直营成本")])]),a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{dense:"",disabled:"","hide-details":"",outlined:"",type:"number"},model:{value:t.editedData.directly_cost,callback:function(e){t.$set(t.editedData,"directly_cost",e)},expression:"editedData.directly_cost"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("加盟成本")])]),a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{dense:"",disabled:"","hide-details":"",outlined:"",type:"number"},model:{value:t.editedData.join_cost,callback:function(e){t.$set(t.editedData,"join_cost",e)},expression:"editedData.join_cost"}})],1),a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("商贸成本")])]),a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{dense:"",disabled:"","hide-details":"",outlined:"",type:"number"},model:{value:t.editedData.business_cost,callback:function(e){t.$set(t.editedData,"business_cost",e)},expression:"editedData.business_cost"}})],1)],1),a("v-row",[a("v-col",{staticClass:"d-flex align-center",attrs:{cols:"1"}},[a("div",[t._v("备注")])]),a("v-col",{attrs:{cols:"11"}},[a("v-textarea",{attrs:{"clear-icon":"mdi-close-circle",clearable:"",dense:"","hide-details":"","no-resize":"",outlined:""},model:{value:t.editedData.other,callback:function(e){t.$set(t.editedData,"other",e)},expression:"editedData.other"}})],1)],1)],2),a("v-card-actions",{staticClass:"d-flex justify-end"},[a("v-btn",{staticClass:"mr-3",attrs:{color:"info"},on:{click:t.submit}},[t._v("确定")]),a("v-btn",{on:{click:function(e){t.editedDialogs=!1}}},[t._v("取消")])],1)],1)],1)],1)],1)}),[],!1,null,"4d0607b0",null);e.default=w.exports,v()(w,{VBtn:f.a,VCard:h.a,VCardActions:p.a,VCardText:p.b,VCardTitle:p.c,VCol:g.a,VDataTable:m.a,VDialog:b.a,VDivider:x.a,VIcon:_.a,VPagination:D.a,VRow:k.a,VSelect:C.a,VTextField:S.a,VTextarea:y.a})},"9b16":function(t,e,a){},a844:function(t,e,a){"use strict";var i=a("5530"),s=(a("a9e3"),a("1681"),a("8654")),d=a("58df"),o=Object(d.a)(s.a);e.a=o.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(t){return!isNaN(parseFloat(t))}},rows:{type:[Number,String],default:5,validator:function(t){return!isNaN(parseInt(t,10))}}},computed:{classes:function(){return Object(i.a)({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},s.a.options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var t=this;setTimeout((function(){t.autoGrow&&t.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var t=this.$refs.input;if(t){t.style.height="0";var e=t.scrollHeight,a=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(a,e)+"px"}},genInput:function(){var t=s.a.options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput:function(t){s.a.options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}})},f2a1:function(t,e,a){"use strict";var i=a("d4ec"),s=a("bee2"),d=a("ade3"),o=a("677a"),n=function(){function t(){Object(i.a)(this,t),Object(d.a)(this,"BASE_URL","admin/GoodsMaterials/")}return Object(s.a)(t,[{key:"findAll",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o.a.doHttp(this.BASE_URL+"findAll","get",{page:t,pageSize:e,field:a})}},{key:"find",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return o.a.doHttp(this.BASE_URL+"find","get",{id:t,field:e})}},{key:"create",value:function(t){return delete t.id,o.a.doHttp(this.BASE_URL+"create","post",t)}},{key:"update",value:function(t){return o.a.doHttp(this.BASE_URL+"update","post",t)}},{key:"delete",value:function(t){return o.a.doHttp(this.BASE_URL+"delete","post",{id:t})}}]),t}();e.a=new n}}]);